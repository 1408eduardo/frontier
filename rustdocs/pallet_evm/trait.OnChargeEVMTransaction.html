<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Handle withdrawing, refunding and depositing of transaction fees. Similar to `OnChargeTransaction` of `pallet_transaction_payment`"><meta name="keywords" content="rust, rustlang, rust-lang, OnChargeEVMTransaction"><title>OnChargeEVMTransaction in pallet_evm - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../pallet_evm/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../pallet_evm/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">OnChargeEVMTransaction</a></h2><div class="sidebar-elems"><section><div class="block"><h3 class="sidebar-title"><a href="#required-associated-types">Required Associated Types</a></h3><ul><li><a href="#associatedtype.LiquidityInfo">LiquidityInfo</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#required-methods">Required Methods</a></h3><ul><li><a href="#tymethod.correct_and_deposit_fee">correct_and_deposit_fee</a></li><li><a href="#tymethod.pay_priority_fee">pay_priority_fee</a></li><li><a href="#tymethod.withdraw_fee">withdraw_fee</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#foreign-impls">Implementations on Foreign Types</a></h3><ul><li><a href="#impl-OnChargeEVMTransaction%3CT%3E-for-()">()</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#implementors">Implementors</a></h3></div></section><h2 class="location"><a href="index.html">In pallet_evm</a></h2><div id="sidebar-vars" data-name="OnChargeEVMTransaction" data-ty="trait" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../pallet_evm/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Trait <a href="index.html">pallet_evm</a>::<wbr><a class="trait" href="#">OnChargeEVMTransaction</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/pallet_evm/lib.rs.html#733-754">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust trait"><code>pub trait OnChargeEVMTransaction&lt;T:&nbsp;<a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>&gt; {
    type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/default/trait.Default.html" title="trait core::default::Default">Default</a>;

    fn <a href="#tymethod.withdraw_fee" class="fnname">withdraw_fee</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;who: &amp;H160, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fee: U256<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>, <a class="enum" href="pallet/enum.Error.html" title="enum pallet_evm::pallet::Error">Error</a>&lt;T&gt;&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.correct_and_deposit_fee" class="fnname">correct_and_deposit_fee</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;who: &amp;H160, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;corrected_fee: U256, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_fee: U256, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;already_withdrawn: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.pay_priority_fee" class="fnname">pay_priority_fee</a>(tip: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>);
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Handle withdrawing, refunding and depositing of transaction fees.
Similar to <code>OnChargeTransaction</code> of <code>pallet_transaction_payment</code></p>
</div></details><h2 id="required-associated-types" class="small-section-header">Required Associated Types<a href="#required-associated-types" class="anchor"></a></h2><div class="methods"><div id="associatedtype.LiquidityInfo" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/pallet_evm/lib.rs.html#734">source</a></div><h4 class="code-header">type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/default/trait.Default.html" title="trait core::default::Default">Default</a></h4></div></div><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="tymethod.withdraw_fee" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/pallet_evm/lib.rs.html#738">source</a></div><h4 class="code-header">fn <a href="#tymethod.withdraw_fee" class="fnname">withdraw_fee</a>(who: &amp;H160, fee: U256) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>, <a class="enum" href="pallet/enum.Error.html" title="enum pallet_evm::pallet::Error">Error</a>&lt;T&gt;&gt;</h4></div></summary><div class="docblock"><p>Before the transaction is executed the payment of the transaction fees
need to be secured.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.correct_and_deposit_fee" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/pallet_evm/lib.rs.html#745-750">source</a></div><h4 class="code-header">fn <a href="#tymethod.correct_and_deposit_fee" class="fnname">correct_and_deposit_fee</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;who: &amp;H160, <br>&nbsp;&nbsp;&nbsp;&nbsp;corrected_fee: U256, <br>&nbsp;&nbsp;&nbsp;&nbsp;base_fee: U256, <br>&nbsp;&nbsp;&nbsp;&nbsp;already_withdrawn: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a><br>) -&gt; Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a></h4></div></summary><div class="docblock"><p>After the transaction was executed the actual fee can be calculated.
This function should refund any overpaid fees and optionally deposit
the corrected amount, and handles the base fee rationing using the provided
<code>OnUnbalanced</code> implementation.
Returns the <code>NegativeImbalance</code> - if any - produced by the priority fee.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.pay_priority_fee" class="method has-srclink"><div class="rightside"><a class="srclink" href="../src/pallet_evm/lib.rs.html#753">source</a></div><h4 class="code-header">fn <a href="#tymethod.pay_priority_fee" class="fnname">pay_priority_fee</a>(tip: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>)</h4></div></summary><div class="docblock"><p>Introduced in EIP1559 to handle the priority tip.</p>
</div></details></div><h2 id="foreign-impls" class="small-section-header">Implementations on Foreign Types<a href="#foreign-impls" class="anchor"></a></h2><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-OnChargeEVMTransaction%3CT%3E-for-()" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/pallet_evm/lib.rs.html#856-888">source</a></span><a href="#impl-OnChargeEVMTransaction%3CT%3E-for-()" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="trait.OnChargeEVMTransaction.html" title="trait pallet_evm::OnChargeEVMTransaction">OnChargeEVMTransaction</a>&lt;T&gt; for <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a> <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::PositiveImbalance: Imbalance&lt;&lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = &lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance: Imbalance&lt;&lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = &lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::PositiveImbalance&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;U256: UniqueSaturatedInto&lt;<a class="type" href="type.BalanceOf.html" title="type pallet_evm::BalanceOf">BalanceOf</a>&lt;T&gt;&gt;,&nbsp;</span></h3></section></summary><div class="docblock"><p>Implementation for () does not specify what to do with imbalance</p>
</div><div class="impl-items"><section id="associatedtype.LiquidityInfo-1" class="associatedtype trait-impl has-srclink"><a href="#associatedtype.LiquidityInfo-1" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a> = <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&lt;&lt;T as <a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>&gt;::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;</h4></section><section id="method.withdraw_fee" class="method trait-impl has-srclink"><span class="rightside"><a class="srclink" href="../src/pallet_evm/lib.rs.html#869-874">source</a></span><a href="#method.withdraw_fee" class="anchor"></a><h4 class="code-header">fn <a href="#tymethod.withdraw_fee" class="fnname">withdraw_fee</a>(who: &amp;H160, fee: U256) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>, <a class="enum" href="pallet/enum.Error.html" title="enum pallet_evm::pallet::Error">Error</a>&lt;T&gt;&gt;</h4></section><section id="method.correct_and_deposit_fee" class="method trait-impl has-srclink"><span class="rightside"><a class="srclink" href="../src/pallet_evm/lib.rs.html#876-883">source</a></span><a href="#method.correct_and_deposit_fee" class="anchor"></a><h4 class="code-header">fn <a href="#tymethod.correct_and_deposit_fee" class="fnname">correct_and_deposit_fee</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;who: &amp;H160, <br>&nbsp;&nbsp;&nbsp;&nbsp;corrected_fee: U256, <br>&nbsp;&nbsp;&nbsp;&nbsp;base_fee: U256, <br>&nbsp;&nbsp;&nbsp;&nbsp;already_withdrawn: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a><br>) -&gt; Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a></h4></section><section id="method.pay_priority_fee" class="method trait-impl has-srclink"><span class="rightside"><a class="srclink" href="../src/pallet_evm/lib.rs.html#885-887">source</a></span><a href="#method.pay_priority_fee" class="anchor"></a><h4 class="code-header">fn <a href="#tymethod.pay_priority_fee" class="fnname">pay_priority_fee</a>(tip: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>)</h4></section></div></details><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-OnChargeEVMTransaction%3CT%3E" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/pallet_evm/lib.rs.html#762-853">source</a></span><a href="#impl-OnChargeEVMTransaction%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, C, OU&gt; <a class="trait" href="trait.OnChargeEVMTransaction.html" title="trait pallet_evm::OnChargeEVMTransaction">OnChargeEVMTransaction</a>&lt;T&gt; for <a class="struct" href="struct.EVMCurrencyAdapter.html" title="struct pallet_evm::EVMCurrencyAdapter">EVMCurrencyAdapter</a>&lt;C, OU&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;C: Currency&lt;&lt;T as Config&gt;::AccountId&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;C::PositiveImbalance: Imbalance&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = C::NegativeImbalance&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;C::NegativeImbalance: Imbalance&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = C::PositiveImbalance&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;OU: OnUnbalanced&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;U256: UniqueSaturatedInto&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance&gt;,&nbsp;</span></h3></section></summary><div class="impl-items"><section id="associatedtype.LiquidityInfo-2" class="associatedtype trait-impl has-srclink"><a href="#associatedtype.LiquidityInfo-2" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a> = <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;</h4></section></div></details></div><script type="text/javascript" src="../implementors/pallet_evm/trait.OnChargeEVMTransaction.js" async></script></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="pallet_evm" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.62.0-nightly (4dd8b420c 2022-05-01)" ></div>
</body></html>